# 监控集群<a name="dws_01_0022"></a>

## 操作场景<a name="section43782126162722"></a>

用户需要查看集群的监控指标信息时，可以通过云监控（Cloud Eye）确认集群各项指标情况。通过监控集群运行时的各项指标，用户可以识别出数据库集群状态异常的时间段，然后在数据库日志中，分析可能存在问题的活动，从而优化数据库性能。本章节包含如下内容：

-   [集群监控指标](#section185715586432)
-   [查看集群监控信息](#section26007147165750)
-   [多节点间的监控指标对比](#section20548025153518)
-   [创建告警规则](#section76461040113)
-   [配置OBS转储](#section61821139193716)

## 集群监控指标<a name="section185715586432"></a>

通过云监控提供的数据仓库服务相关监控指标，用户可以获取有关集群运行状况和性能的信息，并深入了解节点级别的对应信息。

数据仓库服务相关监控指标，具体请参见[表1](#table17857105810438)。

**表 1**  数据仓库服务监控指标

<a name="table17857105810438"></a>
<table><thead align="left"><tr id="row3845105854319"><th class="cellrowborder" valign="top" width="18.6%" id="mcps1.2.5.1.1"><p id="p784515581437"><a name="p784515581437"></a><a name="p784515581437"></a><strong id="b884518582433"><a name="b884518582433"></a><a name="b884518582433"></a>指标名称</strong></p>
</th>
<th class="cellrowborder" valign="top" width="50.949999999999996%" id="mcps1.2.5.1.2"><p id="p284513586434"><a name="p284513586434"></a><a name="p284513586434"></a><strong id="b14845858114310"><a name="b14845858114310"></a><a name="b14845858114310"></a>解释</strong></p>
</th>
<th class="cellrowborder" valign="top" width="17.29%" id="mcps1.2.5.1.3"><p id="p78458586432"><a name="p78458586432"></a><a name="p78458586432"></a><strong id="b6845105817433"><a name="b6845105817433"></a><a name="b6845105817433"></a>取值范围</strong></p>
</th>
<th class="cellrowborder" valign="top" width="13.16%" id="mcps1.2.5.1.4"><p id="p1384520586435"><a name="p1384520586435"></a><a name="p1384520586435"></a><strong id="b38451589434"><a name="b38451589434"></a><a name="b38451589434"></a>指标主体</strong></p>
</th>
</tr>
</thead>
<tbody><tr id="row128461658104319"><td class="cellrowborder" valign="top" width="18.6%" headers="mcps1.2.5.1.1 "><p id="p1484615884315"><a name="p1484615884315"></a><a name="p1484615884315"></a>缓存命中率</p>
</td>
<td class="cellrowborder" valign="top" width="50.949999999999996%" headers="mcps1.2.5.1.2 "><p id="p784620587438"><a name="p784620587438"></a><a name="p784620587438"></a>该指标用于表示需要访问的数据，在内存中可以直接获取的数据量比例，以百分比为单位。</p>
</td>
<td class="cellrowborder" valign="top" width="17.29%" headers="mcps1.2.5.1.3 "><p id="p1846145854311"><a name="p1846145854311"></a><a name="p1846145854311"></a>0%～100%</p>
</td>
<td class="cellrowborder" rowspan="9" valign="top" width="13.16%" headers="mcps1.2.5.1.4 "><p id="p08460585439"><a name="p08460585439"></a><a name="p08460585439"></a>数据仓库集群</p>
</td>
</tr>
<tr id="row1084745818438"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p158461558144311"><a name="p158461558144311"></a><a name="p158461558144311"></a>内存中排序比率</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p10846185824315"><a name="p10846185824315"></a><a name="p10846185824315"></a>该指标用于表示在数据进行排序时，可以直接在内存中排序的数据量比例，以百分比为单位。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p084765824317"><a name="p084765824317"></a><a name="p084765824317"></a>0%～100%</p>
</td>
</tr>
<tr id="row1384711586430"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p2084735817433"><a name="p2084735817433"></a><a name="p2084735817433"></a>文件读取次数</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p1584725804320"><a name="p1584725804320"></a><a name="p1584725804320"></a>该指标用于表示读取数据库文件的累计次数。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p5847175804315"><a name="p5847175804315"></a><a name="p5847175804315"></a>&gt; 0</p>
</td>
</tr>
<tr id="row1984835818434"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p0847195817435"><a name="p0847195817435"></a><a name="p0847195817435"></a>文件写入次数</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p884895864319"><a name="p884895864319"></a><a name="p884895864319"></a>该指标用于表示写入数据库文件的累计次数。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p1384865811434"><a name="p1384865811434"></a><a name="p1384865811434"></a>&gt; 0</p>
</td>
</tr>
<tr id="row6848195824313"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p3848185884320"><a name="p3848185884320"></a><a name="p3848185884320"></a>每秒文件读取次数</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p128481058154310"><a name="p128481058154310"></a><a name="p128481058154310"></a>该指标用于表示每秒读取数据库文件的次数。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p108486588432"><a name="p108486588432"></a><a name="p108486588432"></a>≥ 0</p>
</td>
</tr>
<tr id="row28491058174310"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p1184805813438"><a name="p1184805813438"></a><a name="p1184805813438"></a>每秒文件写入次数</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p4848958114313"><a name="p4848958114313"></a><a name="p4848958114313"></a>该指标用于表示每秒写入数据库文件的次数。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p38481158124317"><a name="p38481158124317"></a><a name="p38481158124317"></a>≥ 0</p>
</td>
</tr>
<tr id="row11849195834313"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p28491958194310"><a name="p28491958194310"></a><a name="p28491958194310"></a>数据量大小</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p284955854314"><a name="p284955854314"></a><a name="p284955854314"></a>该指标用于表示数据库中所有数据总量大小，以兆字节（MB）为单位。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p1484985824317"><a name="p1484985824317"></a><a name="p1484985824317"></a>0MB～36000MB</p>
</td>
</tr>
<tr id="row1285095884312"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p784912582432"><a name="p784912582432"></a><a name="p784912582432"></a>活跃SQL数</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p785012582438"><a name="p785012582438"></a><a name="p785012582438"></a>该指标用于表示数据库当前活动的SQL个数。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p17850175894315"><a name="p17850175894315"></a><a name="p17850175894315"></a>≥ 0</p>
</td>
</tr>
<tr id="row385012587435"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p185011582431"><a name="p185011582431"></a><a name="p185011582431"></a>会话数</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p1850195844317"><a name="p1850195844317"></a><a name="p1850195844317"></a>该指标用于表示数据库当前访问的连接个数。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p785035874315"><a name="p785035874315"></a><a name="p785035874315"></a>≥ 0</p>
</td>
</tr>
<tr id="row08511458144319"><td class="cellrowborder" valign="top" width="18.6%" headers="mcps1.2.5.1.1 "><p id="p13850135819436"><a name="p13850135819436"></a><a name="p13850135819436"></a>CPU使用率</p>
</td>
<td class="cellrowborder" valign="top" width="50.949999999999996%" headers="mcps1.2.5.1.2 "><p id="p9851175874310"><a name="p9851175874310"></a><a name="p9851175874310"></a>该指标用于统计每个集群节点的CPU使用率，以百分比为单位。</p>
</td>
<td class="cellrowborder" valign="top" width="17.29%" headers="mcps1.2.5.1.3 "><p id="p1385185884315"><a name="p1385185884315"></a><a name="p1385185884315"></a>0%～100%</p>
</td>
<td class="cellrowborder" rowspan="13" valign="top" width="13.16%" headers="mcps1.2.5.1.4 "><p id="p198511458204314"><a name="p198511458204314"></a><a name="p198511458204314"></a>集群节点</p>
</td>
</tr>
<tr id="row2851458144317"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p168511658124318"><a name="p168511658124318"></a><a name="p168511658124318"></a>内存使用率</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p2851105820435"><a name="p2851105820435"></a><a name="p2851105820435"></a>该指标用于统计每个集群节点的内存使用率，以百分比为单位。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p1851658184320"><a name="p1851658184320"></a><a name="p1851658184320"></a>0%～100%</p>
</td>
</tr>
<tr id="row3851135815433"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p3851155818437"><a name="p3851155818437"></a><a name="p3851155818437"></a>IOPS</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p1485185818433"><a name="p1485185818433"></a><a name="p1485185818433"></a>该指标用于统计每个集群节点每秒处理的I/O请求数量。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p2085135819437"><a name="p2085135819437"></a><a name="p2085135819437"></a>≥ 0</p>
</td>
</tr>
<tr id="row14853125812437"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p168513588430"><a name="p168513588430"></a><a name="p168513588430"></a>网络输入吞吐量</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p7851185820438"><a name="p7851185820438"></a><a name="p7851185820438"></a>该指标用于统计每秒从网络输入每个集群节点的数据总量。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p5851195819434"><a name="p5851195819434"></a><a name="p5851195819434"></a>≥ 0字节/秒</p>
</td>
</tr>
<tr id="row20853195816432"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p12853125884310"><a name="p12853125884310"></a><a name="p12853125884310"></a>网络输出吞吐量</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p118532586431"><a name="p118532586431"></a><a name="p118532586431"></a>该指标用于统计从每个节点每秒发送到网络的数据总量。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p785385854318"><a name="p785385854318"></a><a name="p785385854318"></a>≥ 0字节/秒</p>
</td>
</tr>
<tr id="row158532585437"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p1853115894318"><a name="p1853115894318"></a><a name="p1853115894318"></a>磁盘利用率</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p1285335824312"><a name="p1285335824312"></a><a name="p1285335824312"></a>该指标用于统计每个集群节点的磁盘使用情况，以百分比为单位。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p1585365884316"><a name="p1585365884316"></a><a name="p1585365884316"></a>0%～100%</p>
</td>
</tr>
<tr id="row7854358184310"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p9854115819432"><a name="p9854115819432"></a><a name="p9854115819432"></a>磁盘总大小</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p2085420588436"><a name="p2085420588436"></a><a name="p2085420588436"></a>该指标用于统计每个集群节点的数据磁盘总大小，以吉字节（GB）为单位。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p6854658184320"><a name="p6854658184320"></a><a name="p6854658184320"></a>100GB～2000GB</p>
</td>
</tr>
<tr id="row138541258204314"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p2085418580434"><a name="p2085418580434"></a><a name="p2085418580434"></a>磁盘使用量</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p15854175834314"><a name="p15854175834314"></a><a name="p15854175834314"></a>该指标用于统计每个集群节点的数据磁盘已用大小，以吉字节（GB）为单位。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p785412581437"><a name="p785412581437"></a><a name="p785412581437"></a>0GB～3600GB</p>
</td>
</tr>
<tr id="row17854958194315"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p1985455854314"><a name="p1985455854314"></a><a name="p1985455854314"></a>磁盘读吞吐量</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p1985415586433"><a name="p1985415586433"></a><a name="p1985415586433"></a>该指标用于统计集群节点数据磁盘每秒读取的数据量，以字节/秒为单位。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p18854165834316"><a name="p18854165834316"></a><a name="p18854165834316"></a>≥ 0字节/秒</p>
</td>
</tr>
<tr id="row1385425815435"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p7854358114310"><a name="p7854358114310"></a><a name="p7854358114310"></a>磁盘写吞吐量</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p15854135894318"><a name="p15854135894318"></a><a name="p15854135894318"></a>该指标用于统计集群节点数据磁盘每秒写入的数据量，以字节/秒为单位。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p085420584433"><a name="p085420584433"></a><a name="p085420584433"></a>≥ 0字节/秒</p>
</td>
</tr>
<tr id="row7855195834313"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p1885417580434"><a name="p1885417580434"></a><a name="p1885417580434"></a>磁盘读耗时</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p2085435818431"><a name="p2085435818431"></a><a name="p2085435818431"></a>该指标用于统计集群节点数据磁盘每次读取数据的平均耗时，以秒为单位。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p16854258114318"><a name="p16854258114318"></a><a name="p16854258114318"></a>&gt; 0秒</p>
</td>
</tr>
<tr id="row38551583436"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p19855125813435"><a name="p19855125813435"></a><a name="p19855125813435"></a>磁盘写耗时</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p1885516586439"><a name="p1885516586439"></a><a name="p1885516586439"></a>该指标用于统计集群节点数据磁盘每次写入数据的平均耗时，以秒为单位。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p4855145804311"><a name="p4855145804311"></a><a name="p4855145804311"></a>&gt; 0秒</p>
</td>
</tr>
<tr id="row385715581436"><td class="cellrowborder" valign="top" headers="mcps1.2.5.1.1 "><p id="p7855358184319"><a name="p7855358184319"></a><a name="p7855358184319"></a>磁盘平均队列长度</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.2 "><p id="p5855165818437"><a name="p5855165818437"></a><a name="p5855165818437"></a>该指标用于统计每个集群节点数据磁盘平均的I/O队列长度。</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.2.5.1.3 "><p id="p5857145818432"><a name="p5857145818432"></a><a name="p5857145818432"></a>≥ 0</p>
</td>
</tr>
</tbody>
</table>

## 查看集群监控信息<a name="section26007147165750"></a>

1.  登录[DWS管理控制台](https://console.huaweicloud.com/dws)。
2.  单击“集群管理“。
3.  在集群列表中，在指定集群所在行，单击“查看监控指标“，打开云监控管理控制台。

    云监控支持查看数据仓库服务中数据仓库集群的监控信息，支持查看集群中各个节点各项监控信息。用户可以根据需要，选择指定的监控指标名称以及时间范围，从而显示监控指标的性能曲线。

    云监控也支持多个节点间的监控指标对比，具体操作请参见[多节点间的监控指标对比](#section20548025153518)。


## 多节点间的监控指标对比<a name="section20548025153518"></a>

1.  在云监控管理控制台的左侧导航栏中，单击“总览  \>  监控面板“。
2.  在“监控面板“页面，单击“创建监控面板“，在弹出对话框中，输入“名称“后，单击“确定“。
3.  在“监控面板“页面，单击右上角的“添加监控视图“。
4.  在弹出的“添加监控视图“窗口中，配置标题和监控项。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >单击“添加监控项“可以添加多个监控指标。  

    **图 1**  添加监控视图<a name="fig259081012442"></a>  
    ![](figures/添加监控视图.png "添加监控视图")

    以对比两个节点间的CPU使用率为例，参数设置如下表所示。

    **表 2**  配置样例

    <a name="table531634516736"></a>
    <table><thead align="left"><tr id="row4060451616736"><th class="cellrowborder" valign="top" width="50%" id="mcps1.2.3.1.1"><p id="p568376716736"><a name="p568376716736"></a><a name="p568376716736"></a>参数名</p>
    </th>
    <th class="cellrowborder" valign="top" width="50%" id="mcps1.2.3.1.2"><p id="p5773201616736"><a name="p5773201616736"></a><a name="p5773201616736"></a>样例值</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row4982610116736"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p2261359816417"><a name="p2261359816417"></a><a name="p2261359816417"></a>资源类型</p>
    </td>
    <td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p2177264216736"><a name="p2177264216736"></a><a name="p2177264216736"></a>数据仓库服务</p>
    </td>
    </tr>
    <tr id="row6173605316736"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p3456440016736"><a name="p3456440016736"></a><a name="p3456440016736"></a>维度</p>
    </td>
    <td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p52128907161035"><a name="p52128907161035"></a><a name="p52128907161035"></a>数据仓库节点</p>
    </td>
    </tr>
    <tr id="row3162373816736"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p1138595516736"><a name="p1138595516736"></a><a name="p1138595516736"></a>监控对象</p>
    </td>
    <td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p4984712416736"><a name="p4984712416736"></a><a name="p4984712416736"></a>dws-64a3-dws-dn-1-1</p>
    <p id="p50143521161249"><a name="p50143521161249"></a><a name="p50143521161249"></a>dws-64a3-dws-cn-cn-1-1</p>
    </td>
    </tr>
    <tr id="row4150216216921"><td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.1 "><p id="p623199316921"><a name="p623199316921"></a><a name="p623199316921"></a>监控指标</p>
    </td>
    <td class="cellrowborder" valign="top" width="50%" headers="mcps1.2.3.1.2 "><p id="p3502938716921"><a name="p3502938716921"></a><a name="p3502938716921"></a>CPU使用率</p>
    </td>
    </tr>
    </tbody>
    </table>

5.  单击“确定“。

    添加成功后，可在“监控面板“区域看到对应的监控视图。鼠标移至监控视图单击右上角的![](figures/icon_dws_monitor_detail.png)，可放大监控视图，查看详细的指标对比数据。


## 创建告警规则<a name="section76461040113"></a>

通过设置DWS的告警规则，用户可以自定义监控目标和通知策略，及时了解DWS运行状态，从而起到预警作用。

设置DWS的告警规则包括设置告警规则名称、监控对象、监控指标、告警阈值、监控周期和是否发送通知等参数。本节介绍设置DWS规则的具体方法。

1.  通过访问以下地址登录DWS管理控制台：[https://console.huaweicloud.com/dws](https://console.huaweicloud.com/dws)。
2.  在左侧导航栏中选择“集群管理”。
3.  在指定集群所在行的“操作”列中，单击“查看监控指标”，进入云监控管理控制台，查看数据仓库服务监控信息。

    确认待查看“监控信息”的集群状态必须为“服务中”，否则不能进行创建告警操作。

4.  在云监控管理控制台的左侧导航树上，选择“告警 \> 告警规则“。
5.  在“告警规则”界面，单击右上方“创建告警规则”。
6.  在“创建告警规则”界面，根据界面提示配置参数。
    1.  选择监控对象，根据界面提示配置参数，然后单击“下一步”。

        **图 2**  选择监控对象<a name="fig368165016118"></a>  
        ![](figures/选择监控对象.png "选择监控对象")

        **表 3**  选择监控对象

        <a name="table161785409115"></a>
        <table><thead align="left"><tr id="row191782040141114"><th class="cellrowborder" valign="top" width="16.36163616361636%" id="mcps1.2.4.1.1"><p id="p7178114021113"><a name="p7178114021113"></a><a name="p7178114021113"></a>参数名称</p>
        </th>
        <th class="cellrowborder" valign="top" width="50.305030503050304%" id="mcps1.2.4.1.2"><p id="p2017816401114"><a name="p2017816401114"></a><a name="p2017816401114"></a>参数说明</p>
        </th>
        <th class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.2.4.1.3"><p id="p16178184011114"><a name="p16178184011114"></a><a name="p16178184011114"></a>取值样例</p>
        </th>
        </tr>
        </thead>
        <tbody><tr id="row10178144021113"><td class="cellrowborder" valign="top" width="16.36163616361636%" headers="mcps1.2.4.1.1 "><p id="p29586526115"><a name="p29586526115"></a><a name="p29586526115"></a>资源类型</p>
        </td>
        <td class="cellrowborder" valign="top" width="50.305030503050304%" headers="mcps1.2.4.1.2 "><p id="p49637525114"><a name="p49637525114"></a><a name="p49637525114"></a>配置告警规则监控的云服务资源名称。</p>
        </td>
        <td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.3 "><p id="p2967155231119"><a name="p2967155231119"></a><a name="p2967155231119"></a>数据仓库服务</p>
        </td>
        </tr>
        <tr id="row17179184031110"><td class="cellrowborder" valign="top" width="16.36163616361636%" headers="mcps1.2.4.1.1 "><p id="p8977155221111"><a name="p8977155221111"></a><a name="p8977155221111"></a>维度</p>
        </td>
        <td class="cellrowborder" valign="top" width="50.305030503050304%" headers="mcps1.2.4.1.2 "><p id="p17989552131113"><a name="p17989552131113"></a><a name="p17989552131113"></a>用于指定告警规则对应指标的维度名称。可以选择“数据仓库节点”或“数据仓库服务”。</p>
        </td>
        <td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.3 "><p id="p179951852151112"><a name="p179951852151112"></a><a name="p179951852151112"></a>数据仓库服务</p>
        </td>
        </tr>
        <tr id="row817919406116"><td class="cellrowborder" valign="top" width="16.36163616361636%" headers="mcps1.2.4.1.1 "><p id="p1124533114"><a name="p1124533114"></a><a name="p1124533114"></a>监控范围</p>
        </td>
        <td class="cellrowborder" valign="top" width="50.305030503050304%" headers="mcps1.2.4.1.2 "><p id="p0613539115"><a name="p0613539115"></a><a name="p0613539115"></a>告警规则适用的资源范围，选择<span class="parmvalue" id="parmvalue5625165419135"><a name="parmvalue5625165419135"></a><a name="parmvalue5625165419135"></a>“指定资源”</span>。</p>
        </td>
        <td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.3 "><p id="p18171653181113"><a name="p18171653181113"></a><a name="p18171653181113"></a>指定资源</p>
        </td>
        </tr>
        <tr id="row131791440101112"><td class="cellrowborder" valign="top" width="16.36163616361636%" headers="mcps1.2.4.1.1 "><p id="p823205351117"><a name="p823205351117"></a><a name="p823205351117"></a>监控对象</p>
        </td>
        <td class="cellrowborder" valign="top" width="50.305030503050304%" headers="mcps1.2.4.1.2 "><p id="p82835351118"><a name="p82835351118"></a><a name="p82835351118"></a>用来配置该告警规则针对的具体资源，可以是一个或多个。对于DWS而言，选择您创建的集群实例ID或节点ID。</p>
        </td>
        <td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.3 "><p id="p431205381114"><a name="p431205381114"></a><a name="p431205381114"></a>-</p>
        </td>
        </tr>
        </tbody>
        </table>

    2.  选择监控指标，可以选择以下两种“选择类型“的任意一种，然后参照界面提示设置参数。
        -   **自定义创建**

            如果当前没有告警模板，“选择类型“设置为“自定义创建“，然后根据界面提示配置参数创建自定义告警规则。

            **图 3**  选择监控指标<a name="fig109641829142510"></a>  
            ![](figures/选择监控指标.png "选择监控指标")

            **表 4**  自定义创建告警规则

            <a name="table15471215125717"></a>
            <table><thead align="left"><tr id="row1047141585716"><th class="cellrowborder" valign="top" width="14.881488148814881%" id="mcps1.2.4.1.1"><p id="p84721514574"><a name="p84721514574"></a><a name="p84721514574"></a>参数</p>
            </th>
            <th class="cellrowborder" valign="top" width="66.07660766076607%" id="mcps1.2.4.1.2"><p id="p1347191518576"><a name="p1347191518576"></a><a name="p1347191518576"></a>参数说明</p>
            </th>
            <th class="cellrowborder" valign="top" width="19.041904190419046%" id="mcps1.2.4.1.3"><p id="p5471215175714"><a name="p5471215175714"></a><a name="p5471215175714"></a>取值样例</p>
            </th>
            </tr>
            </thead>
            <tbody><tr id="row13471315145711"><td class="cellrowborder" valign="top" width="14.881488148814881%" headers="mcps1.2.4.1.1 "><p id="p16862955155719"><a name="p16862955155719"></a><a name="p16862955155719"></a>选择类型</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.07660766076607%" headers="mcps1.2.4.1.2 "><p id="p2866135525716"><a name="p2866135525716"></a><a name="p2866135525716"></a>选择<span class="parmname" id="parmname16962173145815"><a name="parmname16962173145815"></a><a name="parmname16962173145815"></a>“自定义创建”</span>。</p>
            </td>
            <td class="cellrowborder" valign="top" width="19.041904190419046%" headers="mcps1.2.4.1.3 "><p id="p6875135510574"><a name="p6875135510574"></a><a name="p6875135510574"></a>自定义创建</p>
            </td>
            </tr>
            <tr id="row94761525715"><td class="cellrowborder" valign="top" width="14.881488148814881%" headers="mcps1.2.4.1.1 "><p id="p7883955125710"><a name="p7883955125710"></a><a name="p7883955125710"></a>监控指标</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.07660766076607%" headers="mcps1.2.4.1.2 "><p id="p16887955155710"><a name="p16887955155710"></a><a name="p16887955155710"></a>从数据仓库服务支持的监控指标中选择。请参见<a href="#table17857105810438">表1</a>。</p>
            <p id="p589165535715"><a name="p589165535715"></a><a name="p589165535715"></a>例如：</p>
            <a name="ul18921055175712"></a><a name="ul18921055175712"></a><ul id="ul18921055175712"><li>CPU使用率<p id="p2090011552572"><a name="p2090011552572"></a><a name="p2090011552572"></a>该指标用于统计测量对象的CPU使用率，以百分比为单位。</p>
            </li></ul>
            <a name="ul18902165575710"></a><a name="ul18902165575710"></a><ul id="ul18902165575710"><li>数据量大小<p id="p2217115507"><a name="p2217115507"></a><a name="p2217115507"></a>该指标用于表示数据库中所有数据总量大小，以兆字节（MB）为单位。</p>
            </li></ul>
            </td>
            <td class="cellrowborder" valign="top" width="19.041904190419046%" headers="mcps1.2.4.1.3 "><p id="p591325511574"><a name="p591325511574"></a><a name="p591325511574"></a>CPU使用率</p>
            </td>
            </tr>
            <tr id="row114771595719"><td class="cellrowborder" valign="top" width="14.881488148814881%" headers="mcps1.2.4.1.1 "><p id="p7920555105711"><a name="p7920555105711"></a><a name="p7920555105711"></a>告警策略</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.07660766076607%" headers="mcps1.2.4.1.2 "><p id="p19924105525718"><a name="p19924105525718"></a><a name="p19924105525718"></a>触发告警的告警策略。</p>
            <p id="p49261055165717"><a name="p49261055165717"></a><a name="p49261055165717"></a>例如：监控周期为5分钟，连续三个周期原始值≥80%</p>
            </td>
            <td class="cellrowborder" valign="top" width="19.041904190419046%" headers="mcps1.2.4.1.3 "><p id="p17958255125710"><a name="p17958255125710"></a><a name="p17958255125710"></a>-</p>
            </td>
            </tr>
            <tr id="row14721520572"><td class="cellrowborder" valign="top" width="14.881488148814881%" headers="mcps1.2.4.1.1 "><p id="p149631255135719"><a name="p149631255135719"></a><a name="p149631255135719"></a>告警级别</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.07660766076607%" headers="mcps1.2.4.1.2 "><p id="p12968165515570"><a name="p12968165515570"></a><a name="p12968165515570"></a>根据告警的严重程度不同等级，可选择紧急、重要、次要、提示。</p>
            </td>
            <td class="cellrowborder" valign="top" width="19.041904190419046%" headers="mcps1.2.4.1.3 "><p id="p9972205513578"><a name="p9972205513578"></a><a name="p9972205513578"></a>重要</p>
            </td>
            </tr>
            <tr id="row194813156573"><td class="cellrowborder" valign="top" width="14.881488148814881%" headers="mcps1.2.4.1.1 "><p id="p11980205565712"><a name="p11980205565712"></a><a name="p11980205565712"></a>发送通知</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.07660766076607%" headers="mcps1.2.4.1.2 "><p id="p18984125595714"><a name="p18984125595714"></a><a name="p18984125595714"></a>配置是否发送邮件、短信、HTTP和HTTPS通知用户。</p>
            <p id="p1298711556579"><a name="p1298711556579"></a><a name="p1298711556579"></a>选择“是”（推荐选择），会发送通知；选择“否”，不会发送通知。</p>
            </td>
            <td class="cellrowborder" valign="top" width="19.041904190419046%" headers="mcps1.2.4.1.3 "><p id="p5991185515577"><a name="p5991185515577"></a><a name="p5991185515577"></a>是</p>
            </td>
            </tr>
            <tr id="row1248111518578"><td class="cellrowborder" valign="top" width="14.881488148814881%" headers="mcps1.2.4.1.1 "><p id="p79971155145713"><a name="p79971155145713"></a><a name="p79971155145713"></a>生效时间</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.07660766076607%" headers="mcps1.2.4.1.2 "><p id="p201155635710"><a name="p201155635710"></a><a name="p201155635710"></a>该告警规则仅在生效时间内发送通知消息。</p>
            <p id="p23195625719"><a name="p23195625719"></a><a name="p23195625719"></a>如生效时间为00:00-8:00，则该告警规则仅在00:00-8:00发送通知消息。</p>
            </td>
            <td class="cellrowborder" valign="top" width="19.041904190419046%" headers="mcps1.2.4.1.3 "><p id="p6765617577"><a name="p6765617577"></a><a name="p6765617577"></a>-</p>
            </td>
            </tr>
            <tr id="row6486158574"><td class="cellrowborder" valign="top" width="14.881488148814881%" headers="mcps1.2.4.1.1 "><p id="p412195635711"><a name="p412195635711"></a><a name="p412195635711"></a>主题通知</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.07660766076607%" headers="mcps1.2.4.1.2 "><p id="p1616135612572"><a name="p1616135612572"></a><a name="p1616135612572"></a>需要发送告警通知的主题名称。</p>
            <p id="p7191569572"><a name="p7191569572"></a><a name="p7191569572"></a>当发送通知选择“是”时，需要选择已有的主题名称，若此处没有需要的主题则需先创建主题，该功能会调用消息通知服务（SMN），创建主题请参见《消息通知服务用户指南》。</p>
            </td>
            <td class="cellrowborder" valign="top" width="19.041904190419046%" headers="mcps1.2.4.1.3 "><p id="p15299568576"><a name="p15299568576"></a><a name="p15299568576"></a>-</p>
            </td>
            </tr>
            <tr id="row19471222155719"><td class="cellrowborder" valign="top" width="14.881488148814881%" headers="mcps1.2.4.1.1 "><p id="p104112562578"><a name="p104112562578"></a><a name="p104112562578"></a>触发条件</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.07660766076607%" headers="mcps1.2.4.1.2 "><p id="p14461756145711"><a name="p14461756145711"></a><a name="p14461756145711"></a>可以选择“出现告警”、“恢复正常”两种状态，作为触发告警通知的条件。</p>
            </td>
            <td class="cellrowborder" valign="top" width="19.041904190419046%" headers="mcps1.2.4.1.3 "><p id="p45018563576"><a name="p45018563576"></a><a name="p45018563576"></a>-</p>
            </td>
            </tr>
            </tbody>
            </table>

        -   **从模板导入**

            如果当前已有告警模板，可以将“选择类型“设置为“从模板导入“，从而可以使用告警模板快速创建告警规则。

            **图 4**  使用告警模板<a name="fig1933017388148"></a>  
            ![](figures/使用告警模板.png "使用告警模板")

            **表 5**  从模板导入告警规则

            <a name="table62791540103"></a>
            <table><thead align="left"><tr id="row9292740707"><th class="cellrowborder" valign="top" width="14.879999999999999%" id="mcps1.2.4.1.1"><p id="p122978401803"><a name="p122978401803"></a><a name="p122978401803"></a>参数名称</p>
            </th>
            <th class="cellrowborder" valign="top" width="66.08000000000001%" id="mcps1.2.4.1.2"><p id="p029912405013"><a name="p029912405013"></a><a name="p029912405013"></a>参数说明</p>
            </th>
            <th class="cellrowborder" valign="top" width="19.040000000000003%" id="mcps1.2.4.1.3"><p id="p1303104017011"><a name="p1303104017011"></a><a name="p1303104017011"></a>取值样例</p>
            </th>
            </tr>
            </thead>
            <tbody><tr id="row2030784017018"><td class="cellrowborder" valign="top" width="14.879999999999999%" headers="mcps1.2.4.1.1 "><p id="p1131194017018"><a name="p1131194017018"></a><a name="p1131194017018"></a>选择类型</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.08000000000001%" headers="mcps1.2.4.1.2 "><p id="p031417403010"><a name="p031417403010"></a><a name="p031417403010"></a>选择<span class="parmname" id="parmname1231610401304"><a name="parmname1231610401304"></a><a name="parmname1231610401304"></a>“从模板导入”</span>。</p>
            </td>
            <td class="cellrowborder" valign="top" width="19.040000000000003%" headers="mcps1.2.4.1.3 "><p id="p1320144014017"><a name="p1320144014017"></a><a name="p1320144014017"></a>从模板导入</p>
            </td>
            </tr>
            <tr id="row33219409015"><td class="cellrowborder" valign="top" width="14.879999999999999%" headers="mcps1.2.4.1.1 "><p id="p18672471116"><a name="p18672471116"></a><a name="p18672471116"></a>模板</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.08000000000001%" headers="mcps1.2.4.1.2 "><p id="p56704710116"><a name="p56704710116"></a><a name="p56704710116"></a>选择需要导入的模板。</p>
            </td>
            <td class="cellrowborder" valign="top" width="19.040000000000003%" headers="mcps1.2.4.1.3 "><p id="p46631755207"><a name="p46631755207"></a><a name="p46631755207"></a>-</p>
            </td>
            </tr>
            <tr id="row84041340302"><td class="cellrowborder" valign="top" width="14.879999999999999%" headers="mcps1.2.4.1.1 "><p id="p144111240801"><a name="p144111240801"></a><a name="p144111240801"></a>发送通知</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.08000000000001%" headers="mcps1.2.4.1.2 "><p id="p12414124013016"><a name="p12414124013016"></a><a name="p12414124013016"></a>配置是否发送邮件、短信、HTTP和HTTPS通知用户。</p>
            <p id="p64161240805"><a name="p64161240805"></a><a name="p64161240805"></a>选择“是”（推荐选择），会发送通知；选择“否”，不会发送通知。</p>
            </td>
            <td class="cellrowborder" valign="top" width="19.040000000000003%" headers="mcps1.2.4.1.3 "><p id="p124194401903"><a name="p124194401903"></a><a name="p124194401903"></a>是</p>
            </td>
            </tr>
            <tr id="row16421440801"><td class="cellrowborder" valign="top" width="14.879999999999999%" headers="mcps1.2.4.1.1 "><p id="p342410408019"><a name="p342410408019"></a><a name="p342410408019"></a>生效时间</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.08000000000001%" headers="mcps1.2.4.1.2 "><p id="p18426124010013"><a name="p18426124010013"></a><a name="p18426124010013"></a>该告警规则仅在生效时间内发送通知消息。</p>
            <p id="p134283401100"><a name="p134283401100"></a><a name="p134283401100"></a>如生效时间为00:00-8:00，则该告警规则仅在00:00-8:00发送通知消息。</p>
            <div class="note" id="note19739128238"><a name="note19739128238"></a><a name="note19739128238"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="p1774013818311"><a name="p1774013818311"></a><a name="p1774013818311"></a>生效时间暂只支持华南-广州、华东-上海二，其他区域暂不支持。</p>
            </div></div>
            </td>
            <td class="cellrowborder" valign="top" width="19.040000000000003%" headers="mcps1.2.4.1.3 "><p id="p17431184012017"><a name="p17431184012017"></a><a name="p17431184012017"></a>-</p>
            </td>
            </tr>
            <tr id="row144335407019"><td class="cellrowborder" valign="top" width="14.879999999999999%" headers="mcps1.2.4.1.1 "><p id="p1943694017015"><a name="p1943694017015"></a><a name="p1943694017015"></a>主题通知</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.08000000000001%" headers="mcps1.2.4.1.2 "><p id="p9440154017013"><a name="p9440154017013"></a><a name="p9440154017013"></a>需要发送告警通知的主题名称。</p>
            <p id="p184423401703"><a name="p184423401703"></a><a name="p184423401703"></a>当发送通知选择“是”时，需要选择已有的主题名称，若此处没有需要的主题则需先创建主题，该功能会调用消息通知服务（SMN），创建主题请参见《消息通知服务用户指南》。</p>
            </td>
            <td class="cellrowborder" valign="top" width="19.040000000000003%" headers="mcps1.2.4.1.3 "><p id="p14445134014012"><a name="p14445134014012"></a><a name="p14445134014012"></a>-</p>
            </td>
            </tr>
            <tr id="row19446740107"><td class="cellrowborder" valign="top" width="14.879999999999999%" headers="mcps1.2.4.1.1 "><p id="p114501440903"><a name="p114501440903"></a><a name="p114501440903"></a>触发条件</p>
            </td>
            <td class="cellrowborder" valign="top" width="66.08000000000001%" headers="mcps1.2.4.1.2 "><p id="p7452104010013"><a name="p7452104010013"></a><a name="p7452104010013"></a>可以选择“出现告警”、“恢复正常”两种状态，作为触发告警通知的条件。</p>
            </td>
            <td class="cellrowborder" valign="top" width="19.040000000000003%" headers="mcps1.2.4.1.3 "><p id="p19455104018020"><a name="p19455104018020"></a><a name="p19455104018020"></a>-</p>
            </td>
            </tr>
            </tbody>
            </table>


    3.  规则信息，根据界面提示配置参数，如[表6](#table178061044145)所示。配置完成后，单击“创建”，完成告警规则的添加。

        **表 6**  规则信息

        <a name="table178061044145"></a>
        <table><thead align="left"><tr id="row158061444940"><th class="cellrowborder" valign="top" width="14.941494149414941%" id="mcps1.2.4.1.1"><p id="p58061441549"><a name="p58061441549"></a><a name="p58061441549"></a>参数名称</p>
        </th>
        <th class="cellrowborder" valign="top" width="68.70687068706872%" id="mcps1.2.4.1.2"><p id="p280718441141"><a name="p280718441141"></a><a name="p280718441141"></a>参数描述</p>
        </th>
        <th class="cellrowborder" valign="top" width="16.351635163516352%" id="mcps1.2.4.1.3"><p id="p138072441848"><a name="p138072441848"></a><a name="p138072441848"></a>样例值</p>
        </th>
        </tr>
        </thead>
        <tbody><tr id="row1680714443419"><td class="cellrowborder" valign="top" width="14.941494149414941%" headers="mcps1.2.4.1.1 "><p id="p1148710521043"><a name="p1148710521043"></a><a name="p1148710521043"></a>名称</p>
        </td>
        <td class="cellrowborder" valign="top" width="68.70687068706872%" headers="mcps1.2.4.1.2 "><p id="p154921752249"><a name="p154921752249"></a><a name="p154921752249"></a>系统会随机产生一个名称，用户也可以进行修改。</p>
        </td>
        <td class="cellrowborder" valign="top" width="16.351635163516352%" headers="mcps1.2.4.1.3 "><p id="p1549645214419"><a name="p1549645214419"></a><a name="p1549645214419"></a>alarm-fk0k</p>
        </td>
        </tr>
        <tr id="row1880724410418"><td class="cellrowborder" valign="top" width="14.941494149414941%" headers="mcps1.2.4.1.1 "><p id="p1050217521247"><a name="p1050217521247"></a><a name="p1050217521247"></a>描述</p>
        </td>
        <td class="cellrowborder" valign="top" width="68.70687068706872%" headers="mcps1.2.4.1.2 "><p id="p125062529410"><a name="p125062529410"></a><a name="p125062529410"></a>告警规则描述（此参数非必填项）。</p>
        </td>
        <td class="cellrowborder" valign="top" width="16.351635163516352%" headers="mcps1.2.4.1.3 "><p id="p115101521946"><a name="p115101521946"></a><a name="p115101521946"></a>-</p>
        </td>
        </tr>
        </tbody>
        </table>



## 配置OBS转储<a name="section61821139193716"></a>

云监控各监控指标的原始数据的保留周期为两天，超过保留周期后原始数据将不再保存。用户可以开通对象存储服务，然后将原始数据同步保存至OBS，以保存更长时间。

关于如何配置OBS转储，具体请参见[《云监控服务用户指南》](https://support.huaweicloud.com/ces/index.html)中“查看云服务历史监控数据 \> 配置数据存储”章节。

