# 管理参数模板<a name="dws_01_0126"></a>

用户可以在DWS管理控制台上[创建参数模板](#section197345189212)、[修改参数模板](#section940613324129)、[删除参数模板](#section18540123972615)、[应用参数模板到集群](#section17765171763118)以及[修改集群参数](#section12703523122616)。

## 参数模板概述<a name="section11563104515277"></a>

参数模板是一组适用于数据仓库的参数，这些参数包括会话超时时间、日期和时间格式等。用户可以通过设置数据库参数，使数据库更好地适配实际情况，并运行业务。在创建集群、恢复集群时，必须为集群指定一个参数模板，指定的参数模板中的参数将被应用于该DWS集群。当集群创建成功后，用户可以在集群详情页面修改集群参数，也可以在参数模板管理页面，选择现有参数模板或者创建新的参数模板来重新应用到对应集群。

DWS为每个版本的数据仓库预置了一个默认参数模板，默认参数模板不支持删除，参数模板中的参数也不支持修改。如果用户想要修改参数值，可以创建一个自定义参数模板，自定义参数模板中的参数值允许被修改。

## 参数模板参数说明<a name="section926416313488"></a>

**表 1**  参数模板参数说明

<a name="table122717208620"></a>
<table><thead align="left"><tr id="row92716201567"><th class="cellrowborder" valign="top" width="26.019801980198014%" id="mcps1.2.4.1.1"><p id="p627820868"><a name="p627820868"></a><a name="p627820868"></a><strong id="b192968471772"><a name="b192968471772"></a><a name="b192968471772"></a>参数名称</strong></p>
</th>
<th class="cellrowborder" valign="top" width="57.18811881188118%" id="mcps1.2.4.1.2"><p id="p22722018611"><a name="p22722018611"></a><a name="p22722018611"></a><strong id="b6296747077"><a name="b6296747077"></a><a name="b6296747077"></a>参数描述</strong></p>
</th>
<th class="cellrowborder" valign="top" width="16.792079207920793%" id="mcps1.2.4.1.3"><p id="p162719204610"><a name="p162719204610"></a><a name="p162719204610"></a><strong id="b429614479717"><a name="b429614479717"></a><a name="b429614479717"></a>默认值</strong></p>
</th>
</tr>
</thead>
<tbody><tr id="row7273201611"><td class="cellrowborder" valign="top" width="26.019801980198014%" headers="mcps1.2.4.1.1 "><p id="p72792012610"><a name="p72792012610"></a><a name="p72792012610"></a>session_timeout</p>
</td>
<td class="cellrowborder" valign="top" width="57.18811881188118%" headers="mcps1.2.4.1.2 "><p id="p989412394507"><a name="p989412394507"></a><a name="p989412394507"></a>Session闲置超时时间，单位为秒，0表示关闭超时限制。</p>
</td>
<td class="cellrowborder" valign="top" width="16.792079207920793%" headers="mcps1.2.4.1.3 "><p id="p112719201461"><a name="p112719201461"></a><a name="p112719201461"></a>600</p>
</td>
</tr>
<tr id="row9271201464"><td class="cellrowborder" valign="top" width="26.019801980198014%" headers="mcps1.2.4.1.1 "><p id="p99367618710"><a name="p99367618710"></a><a name="p99367618710"></a>query_dop</p>
</td>
<td class="cellrowborder" valign="top" width="57.18811881188118%" headers="mcps1.2.4.1.2 "><p id="p952165575012"><a name="p952165575012"></a><a name="p952165575012"></a>用户自定义的查询并行度。</p>
<a name="ul89106417554"></a><a name="ul89106417554"></a><ul id="ul89106417554"><li>配置为0表示查询并行度自适应。</li><li>配置为1表示查询不并行。</li><li>配置为2表示查询并行度为2。</li></ul>
</td>
<td class="cellrowborder" valign="top" width="16.792079207920793%" headers="mcps1.2.4.1.3 "><p id="p1327020962"><a name="p1327020962"></a><a name="p1327020962"></a>0</p>
</td>
</tr>
<tr id="row10271220063"><td class="cellrowborder" valign="top" width="26.019801980198014%" headers="mcps1.2.4.1.1 "><p id="p1527192012613"><a name="p1527192012613"></a><a name="p1527192012613"></a>datestyle</p>
</td>
<td class="cellrowborder" valign="top" width="57.18811881188118%" headers="mcps1.2.4.1.2 "><p id="p138941459514"><a name="p138941459514"></a><a name="p138941459514"></a>设置日期和时间值的显示格式。</p>
</td>
<td class="cellrowborder" valign="top" width="16.792079207920793%" headers="mcps1.2.4.1.3 "><p id="p02720201769"><a name="p02720201769"></a><a name="p02720201769"></a>ISO,MDY</p>
</td>
</tr>
<tr id="row6271820468"><td class="cellrowborder" valign="top" width="26.019801980198014%" headers="mcps1.2.4.1.1 "><p id="p172711201368"><a name="p172711201368"></a><a name="p172711201368"></a>failed_login_attempts</p>
</td>
<td class="cellrowborder" valign="top" width="57.18811881188118%" headers="mcps1.2.4.1.2 "><p id="p188041435115"><a name="p188041435115"></a><a name="p188041435115"></a>输入密码错误的次数达到该参数所设置的值时，帐户将会被自动锁定。配置为0时表示不限制密码输入错误的次数。</p>
</td>
<td class="cellrowborder" valign="top" width="16.792079207920793%" headers="mcps1.2.4.1.3 "><p id="p17272020463"><a name="p17272020463"></a><a name="p17272020463"></a>10</p>
</td>
</tr>
<tr id="row5271202614"><td class="cellrowborder" valign="top" width="26.019801980198014%" headers="mcps1.2.4.1.1 "><p id="p1061102513710"><a name="p1061102513710"></a><a name="p1061102513710"></a>timezone</p>
</td>
<td class="cellrowborder" valign="top" width="57.18811881188118%" headers="mcps1.2.4.1.2 "><p id="p144305236513"><a name="p144305236513"></a><a name="p144305236513"></a>设置显示和解释时间类型数值时使用的时区。</p>
</td>
<td class="cellrowborder" valign="top" width="16.792079207920793%" headers="mcps1.2.4.1.3 "><p id="p102710201963"><a name="p102710201963"></a><a name="p102710201963"></a>UTC</p>
</td>
</tr>
<tr id="row42710205610"><td class="cellrowborder" valign="top" width="26.019801980198014%" headers="mcps1.2.4.1.1 "><p id="p94694329715"><a name="p94694329715"></a><a name="p94694329715"></a>log_timezone</p>
</td>
<td class="cellrowborder" valign="top" width="57.18811881188118%" headers="mcps1.2.4.1.2 "><p id="p152718204614"><a name="p152718204614"></a><a name="p152718204614"></a>设置服务器写日志文件时使用的时区。</p>
</td>
<td class="cellrowborder" valign="top" width="16.792079207920793%" headers="mcps1.2.4.1.3 "><p id="p10271420269"><a name="p10271420269"></a><a name="p10271420269"></a>UTC</p>
</td>
</tr>
<tr id="row2363396016"><td class="cellrowborder" valign="top" width="26.019801980198014%" headers="mcps1.2.4.1.1 "><p id="p183612395015"><a name="p183612395015"></a><a name="p183612395015"></a>enable_resource_record</p>
</td>
<td class="cellrowborder" valign="top" width="57.18811881188118%" headers="mcps1.2.4.1.2 "><p id="p17360391100"><a name="p17360391100"></a><a name="p17360391100"></a>设置是否开启资源记录功能。</p>
<p id="p128944115188"><a name="p128944115188"></a><a name="p128944115188"></a>当SQL语句实际执行时间大于resource_track_duration参数值（默认为60s，可自行设置）时，监控信息将会归档。</p>
<p id="p9539556165016"><a name="p9539556165016"></a><a name="p9539556165016"></a>此功能开启后会引起存储空间膨胀及轻微性能影响，不用时请关闭。</p>
<div class="note" id="note1940316357188"><a name="note1940316357188"></a><a name="note1940316357188"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="ul03121921102018"></a><a name="ul03121921102018"></a><ul id="ul03121921102018"><li>归档：监控信息先存入history视图，归档在info表。归档时间为三分钟，归档后history视图中的记录会被清除。</li><li>history视图：GS_WLM_SESSION_HISTORY，对应存入info表：GS_WLM_SESSION_INFO。</li><li>history视图：GS_WLM_OPERATOR_HISTORY，对应存入info表：GS_WLM_OPERATOR_INFO。</li></ul>
</div></div>
</td>
<td class="cellrowborder" valign="top" width="16.792079207920793%" headers="mcps1.2.4.1.3 "><p id="p1236739604"><a name="p1236739604"></a><a name="p1236739604"></a>off</p>
</td>
</tr>
<tr id="row175112022171419"><td class="cellrowborder" valign="top" width="26.019801980198014%" headers="mcps1.2.4.1.1 "><p id="p15959724161415"><a name="p15959724161415"></a><a name="p15959724161415"></a>resource_track_duration</p>
</td>
<td class="cellrowborder" valign="top" width="57.18811881188118%" headers="mcps1.2.4.1.2 "><p id="p4959162414141"><a name="p4959162414141"></a><a name="p4959162414141"></a>设置当前会话资源监控实时视图中记录的语句执行结束后进行归档的最小执行时间。</p>
<a name="ul295922416142"></a><a name="ul295922416142"></a><ul id="ul295922416142"><li>值为0时，资源监控实时视图中记录的所有语句都进行历史信息归档。</li><li>值大于0时，资源监控实时视图中记录的语句的执行时间超过这个值就会进行历史信息归档。</li></ul>
</td>
<td class="cellrowborder" valign="top" width="16.792079207920793%" headers="mcps1.2.4.1.3 "><p id="p5960224131415"><a name="p5960224131415"></a><a name="p5960224131415"></a>60s</p>
</td>
</tr>
</tbody>
</table>

## 创建参数模板<a name="section197345189212"></a>

如果默认参数模板中的参数值无法满足业务，用户可以创建自定义参数模板，并修改其中的参数值，从而更好地适配业务。

创建参数模板操作步骤如下：

1.  通过访问以下地址登录DWS管理控制台：[https://console.huaweicloud.com/dws](https://console.huaweicloud.com/dws)。
2.  在左侧导航栏中，单击“参数模板管理“。
3.  单击“创建参数模板“，然后设置以下参数。

    -   “数据库引擎“：选择一个数据库引擎。
    -   “数据库版本“：选择一个数据库版本。
    -   “参数模板名“：填写新参数模板的名称。

        参数模板名称长度为4～64个字符，必须以字母开头，不区分大小写，可以包含字母、数字、中划线或者下划线，不能包含其他的特殊字符。

    -   “描述“：填写新参数模板的描述信息。此参数为可选参数。

        参数模板描述的字符长度为0～256，且特殊字符!<\>'=&"不支持。


    **图 1**  创建参数模板<a name="fig16736131817213"></a>  
    ![](figures/创建参数模板.png "创建参数模板")

4.  单击“确定“，开始创建参数模板。

## 修改参数模板<a name="section940613324129"></a>

对于用户自定义创建的参数模板，可以修改其中的参数值，但是默认参数模板中的参数值不支持修改。

1.  通过访问以下地址登录DWS管理控制台：[https://console.huaweicloud.com/dws](https://console.huaweicloud.com/dws)。
2.  在左侧导航栏中，单击“参数模板管理“。
3.  在“名称“列单击待修改的参数模板名称，进入参数列表页面。
4.  在待修改的参数所对应的“值“中，输入新的值。修改完，单击“保存“
5.  在“修改预览“对话框中，确认无误后，单击“保存“。

## 删除参数模板<a name="section18540123972615"></a>

对于多余或者长期不使用的参数模板，用户可以将其删除，但是不支持删除默认参数模板。成功删除的参数模板无法恢复，请用户谨慎操作。

1.  通过访问以下地址登录DWS管理控制台：[https://console.huaweicloud.com/dws](https://console.huaweicloud.com/dws)。
2.  在左侧导航栏中，单击“参数模板管理“。
3.  在待删除的参数模板右侧，单击“删除“。
4.  在弹出的对话框，单击“是“。

## 应用参数模板到集群<a name="section17765171763118"></a>

集群创建成功后，用户可以为集群应用一个新的参数模板，将参数模板中所有参数的值应用到对应的集群中。

应用参数模板的操作步骤如下：

1.  通过访问以下地址登录DWS管理控制台：[https://console.huaweicloud.com/dws](https://console.huaweicloud.com/dws)。
2.  在左侧导航栏中，单击“参数模板管理“。
3.  选择一个目标参数模板，在“操作“列中单击“应用“。
4.  在“参数模板应用“对话框，选择目标集群。

    您可以将所选的参数模板应用到与该参数模板对应版本的集群上。

    **图 2**  参数模板应用<a name="fig131711019549"></a>  
    ![](figures/参数模板应用.png "参数模板应用")

5.  单击“确定“。

    如果重新应用的参数模板与集群原来的参数有不同的参数值，系统会弹窗显示两组参数值的对比。


## 修改集群参数<a name="section12703523122616"></a>

集群创建成功后，用户可以根据实际需要修改集群参数。

修改集群参数的操作步骤如下：

1.  通过访问以下地址登录DWS管理控制台：[https://console.huaweicloud.com/dws](https://console.huaweicloud.com/dws)。
2.  在左侧导航栏中，单击“集群管理“。
3.  在集群列表中找到所需要的集群，然后单击集群名称，进入集群“基本信息“页面。
4.  单击“参数修改“页签，修改相应的参数值。单击“保存“。
5.  在“修改预览“窗口，确认修改无误后，单击“保存“。

