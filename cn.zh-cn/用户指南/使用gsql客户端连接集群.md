# 使用gsql客户端连接集群<a name="dws_01_0037"></a>

用户在创建好数据仓库集群，开始使用集群数据库之前，需要使用数据库SQL客户端连接到数据库。DWS提供了与集群版本配套的gsql命令行客户端工具，您可以使用gsql客户端通过集群的公网地址或者内网地址访问集群。

## 使用gsql命令行客户端连接集群<a name="section2664278815443"></a>

1.  准备一个Linux弹性云服务器，用于安装和运行gsql客户端。

    具体操作请参见[准备ECS作为gsql客户端主机](准备ECS作为gsql客户端主机.md)。

2.  下载DWS客户端。

    具体请参见[下载客户端](下载客户端.md)。

3.  使用WinSCP工具，将客户端工具上传到一个待安装客户端的Linux主机上。

    执行上传操作的用户需要对客户端的目标存放目录有完全控制权限。

4.  （可选）如果要使用SSL方式连接集群，请参考[使用SSL进行安全的TCP/IP连接](使用SSL进行安全的TCP-IP连接.md)章节，在客户端主机配置SSL认证相关的参数。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >SSL连接方式的安全性高于非SSL方式，建议在客户端使用SSL连接方式。  

5.  使用SSH会话工具，远程登录客户端主机。

    弹性云服务器的登录方法请参见《弹性云服务器用户指南》中的[SSH密码方式登录](https://support.huaweicloud.com/usermanual-ecs/zh-cn_topic_0017955633.html)章节。

6.  执行以下命令解压客户端工具。

    **cd <客户端存放路径****\>**

    ****tar -xvf dws\_client\_redhat\_x64.tar.gz****

    其中：

    -   <客户端存放路径**\>**：请替换为实际的客户端存放路径。
    -   “dws\_client\_redhat\_x64.tar.gz“：是以“RedHat x64“对应的客户端工具包作为举例，请替换为实际下载的包名。

7.  执行以下命令配置客户端。

    **source gsql\_env.sh**

    提示以下信息表示客户端已配置成功

    ```
    All things done.
    ```

    配置后可以马上使用客户端连接DWS集群。

8.  执行以下命令，使用gsql客户端连接DWS集群中的数据库。

    **gsql -d <数据库名称\> -h <集群地址\> -U <数据库用户\> -p <数据库端口\> -r**

    参数说明如下：

    -   “数据库名称“：输入所要连接的数据库名称。首次使用客户端连接集群时，请指定为集群的默认数据库“postgres“。
    -   “数据库用户“：输入集群数据库的用户名。首次使用客户端连接集群时，请指定为创建集群时设置的默认管理员用户，例如“dbadmin“。
    -   “数据库端口“：输入创建集群时设置的“数据库端口“。
    -   “集群地址“：请参见[获取集群连接地址](获取集群连接地址.md)进行获取。如果通过公网地址连接，请指定为集群“公网访问地址“或“公网访问域名“，如果通过内网地址连接，请指定为集群“内网访问地址“或“内网访问域名“。

    例如，执行以下命令连接DWS集群的默认数据库postgres：

    ****gsql -d postgres -h 10.168.0.74 -U dbadmin -p 8000 -r****

    根据界面提示输入密码后，显示如下信息表示gsql工具已经连接成功：

    ```
    postgres=>
    ```


## gsql命令参考<a name="section41003216539"></a>

有关gsql的命令参考和更多信息，请参见[《数据仓库服务工具指南》](https://support.huaweicloud.com/tg-dws/dws_07_0004.html)。

